<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="./css/all.css">
    <script src="./js/text.js"></script>
</head>

<body>
        <div id="app">
            <div class="wrap headerwrap">
                <ul class="navBox">
                    <li><a href="./shouye.html">首页</a> </li>
                    <li><a href="allproduct.html" style="color: 242B39;"> 全部商品 </a></li>
                    <li><a href="shopping.html"> 购物车</a>  </li>
                    <li><a href="./dizhi.html"> 地址管理 </a> </li>
                    <li><a href="#"> 3D管理 </a> </li>
                </ul>
            </div>
            <div class="details wrap">
                <div style="margin: 10px 0px;"></div>
                <div class="left">
                    <div class="leftone">
                        <div class="bigImg">
                            <img style="width: 100%;height: 100%;">
                        </div>
                    </div>
                    <div class="lefttwo">
                        <div class="top">
                            <h2>联想笔记本电脑 小新Air14 英特尔酷睿i5 14英寸轻薄本(i5 16G 512G 高色域 大电池)银 商务办公手提电脑</h2>
                            <div class="score">$89.99</div>
                            <div style="font-size: 14px; float: right; height: 37px; line-height: 37px;">累计销售2000+</div>
                        </div>
                        <div class="down">
                            <div class="quantity">
                                <strong>数量<span>*礼品库存99件</span></strong>
                                <div class="step">
                                    <div class="reduce">-</div>
                                    <input type="text" disabled="disabled" value="1" class="number">
                                    <div class="add">+</div>
                                </div>
                            </div>
                            <div class="btns">
                                <div class="addToCart" style="background: #3dc36b;">加入购物车</div>
                                <div class="buyNow" style="background: #fd604d;">立即购买</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="right">
                    <h3>你还可以购买</h3>
                    <ul>
                        <li>
                            <div class="l"><img  alt=""></div>
                            <div class="r">
                                <div class="title">威觉裤子男春夏季九分牛仔裤男士休闲直筒宽松坠感高街港风潮牌长裤子 直筒浅蓝色 XL</div>
                                <div class="score"><span>$99.99</span></div>
                            </div>
                        </li>
                        <li>
                            <div class="l"><img  alt=""></div>
                            <div class="r">
                                <div class="title">威觉裤子男春夏季九分牛仔裤男士休闲直筒宽松坠感高街港风潮牌长裤子 直筒浅蓝色 XL</div>
                                <div class="score"><span>$99.99</span></div>
                            </div>
                        </li>
                        <li>
                            <div class="l"><img  alt=""></div>
                            <div class="r">
                                <div class="title">威觉裤子男春夏季九分牛仔裤男士休闲直筒宽松坠感高街港风潮牌长裤子 直筒浅蓝色 XL</div>
                                <div class="score"><span>$99.99</span></div>
                            </div>
                        </li>
                        <li>
                            <div class="l"><img  alt=""></div>
                            <div class="r">
                                <div class="title">威觉裤子男春夏季九分牛仔裤男士休闲直筒宽松坠感高街港风潮牌长裤子 直筒浅蓝色 XL</div>
                                <div class="score"><span>$99.99</span></div>
                            </div>
                        </li>
                        <li>
                            <div class="l"><img  alt=""></div>
                            <div class="r">
                                <div class="title">威觉裤子男春夏季九分牛仔裤男士休闲直筒宽松坠感高街港风潮牌长裤子 直筒浅蓝色 XL</div>
                                <div class="score"><span>$99.99</span></div>
                            </div>
                        </li>
                        <li>
                            <div class="l"><img  alt=""></div>
                            <div class="r">
                                <div class="title">威觉裤子男春夏季九分牛仔裤男士休闲直筒宽松坠感高街港风潮牌长裤子 直筒浅蓝色 XL</div>
                                <div class="score"><span>$99.99</span></div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="bottomton">
                    <div class="xuanzhe">
                        <div>用户管理</div>
                        <div>配置管理</div>
                        <div>角色管理</div>
                        <div>定时任务补偿</div>
                    </div>
                </div>
            </div>
            <div class="footer-b">
                <ul class="heart wrap">
                    <li>
                        <div class="footer-i">
                            <img src="./imgs/logox.df5dd860.png" alt="">
                            <p> 易购商城是国内知名B2C商城。其产品包括影像影音、
                                手机通讯、电脑产品、办公设备、生活电器、汽车用品
                                和日用百货等万种优质商品，是中国电子商务领域的电子商务网站之一 。
                                易购商城地处“中国四大古都”之一，有“六朝古都”之称的江苏省南京市易购
                                商城是国内知名B2C商城。其产品包括影像影音、手机通讯、电脑产品、办公设
                                备、 生活电器、汽车用品和日用百货等万种优质商品，是中国电子商务领域的
                                电子商务网站之一. </p>
                        </div>
                    </li>
                    <li class="one">
                        <ul>
                            <li>
                                <img src="./imgs/weixin.jpg" alt="">
                                <a href="#">微信</a>
                            </li>
                            <li>
                                <a href="">新浪微博</a>
                            </li>
                            <li>
                                <img src="./imgs/0c13b51d86daaa4b6931df9d627f7ae9_1.jpg" alt="">
                                <a href="">联系我们</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <div class="footer-r">
                            <p>全国免费咨询热线</p>
                            <h3>020-85628002</h3>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
</body>
<script>
    var img = document.querySelector('.details .leftone .bigImg img')//大图片
    var title = document.querySelector('.details .left .lefttwo .top h2')//商品简介
    var score = document.querySelector('.details .left .lefttwo .top .score')//商品价格
    var reduce = document.querySelector('.details .left .lefttwo .down .step .reduce')//减号
    var add = document.querySelector('.details .left .lefttwo .down .step .add')//加号
    var quantity = document.querySelector('.details .left .lefttwo .down  .step .number')//数量
    var shopping = document.querySelector('.details .left .lefttwo .down .btns .addToCart')//购物车
    var imgsate = document.querySelectorAll('.details .right ul li .l img')//随机照片
    var titleate = document.querySelectorAll('.details .right ul li .r .title')//随机商品介绍
    var scoreate = document.querySelectorAll('.details .right ul li .r .score span')//随机商品价钱
    //获取id
    var id = sessionStorage.getItem('user')
    if(id == null){
    alert("请先登录")
    location.replace("./login.html");
    }
    //获取商品值
    var queryString = window.location.search;   // 获取 URL 中的参数
    var params = new URLSearchParams(queryString); // 将参数字符串转换为对象
    var pagesate = params.get('n');//页数request
    var productate = params.get('j');//第几个商品
   

    ajax({//显示页面
        type: 'get',
        url: '/good/getAllGoods/'+ pagesate/*传过来的页数 参数：pagesate*/ +'/4', //1-7 //0-3 // 7-1
        data: {
        },
        success(data) {
            console.log(data.data.records[productate]);
            var rout = data.data.records[productate]//参数：productate
            img.src = rout.goodPic
            title.innerHTML = rout.goodName
            score.innerHTML = '$' + rout.price
            shopping.onclick = function () {
            ajax({ //添加
            type: 'post',
            url: '/shopCar/addShopCar',
            data: {
                userId: id,
                goodId: rout.id,
                num: quantity.value
            },
            success(data) {
              if(data.msg ==  "success"){
                alert(data.msg);
                location.replace("shopping.html");
              }
            else{
                alert(data.msg);
            }
            }
        })
    }
        }
    })
    for(let i= 0;i < imgsate.length;i++){//随机商品
      var ate = Random(4)
     ajax({
        type: 'get',
        url: '/good/getAllGoods/'+ ate +'/4', //0-7 //0-3 // 7-1
        data: {
        },
        success(data) {
            if(ate != 7){
            var rout = data.data.records[Random(4)]    
        }else{
            var rout = data.data.records[0]
        }
            imgsate[i].src = rout.goodPic
            titleate[i].innerHTML = rout.goodName
            scoreate[i].innerHTML = '$' + rout.price
        }
    })}
    
    function Random(n) {//获取随机数
        var Random = Math.floor(Math.random() * n);
        return Random
    }

    
    add.onclick = function () {
        quantity.innerHTML = quantity.value++;
    }

    reduce.onclick = function () {
        if (quantity.value > 1) {
            quantity.innerHTML = quantity.value--;
        }
        else {
            alert("最少为一件")
        }
    }
</script>

</html>